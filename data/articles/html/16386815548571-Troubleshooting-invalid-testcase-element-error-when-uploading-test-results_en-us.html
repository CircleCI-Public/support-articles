<h1 id="h_01HSYTJTB630G9BG4QGD3AKE1X">Problem:</h1>
<p>When uploading your test results to CircleCI in a job, you may see the following error:</p>
<pre style="background-color: #f3f3f3;" data-darkreader-inline-bgcolor=""><code>invalid testcase element</code></pre>
<p>This can happen when CircleCI is unable to parse the test results generated by your test runner.</p>
<h2 id="h_01HSYTJTB65GBN1PXS1X2TEYYJ">Prerequisites:</h2>
<p>Please verify the content of the test resultsby uploading the file as an artifact. This is helpful to verify what is being parsed by CircleCI. Here is an example of how to upload an artifact:</p>
<pre style="background-color: #f3f3f3;" data-darkreader-inline-bgcolor=""><code>- store_artifacts:
    path: test-results.xml</code></pre>
<h2 id="h_01HSYTJTB6KRDBH8AYJGQ7M0Z8">Solutions:</h2>
<ul>
    <li>Solution - Use xmlstarlet to manipulate xml element names
        <ul>
            <li>
                <p>It will be necessary to modify the element names so that they are accepted by CircleCI's test result parser. One tool that can be used is xmlstarlet.</p>
                <p>Here is an example of a job step that renames the invalid elements flakyFailture, rerunFailure, and flakyError to failure in a file named test.xml:</p>
                <pre style="background-color: #f3f3f3;" data-darkreader-inline-bgcolor=""><code>- run:
    name: Correct formatting of test results
    command: |
      xmlstarlet ed --inplace --rename '//testsuite/testcase/flakyFailure' -v 'failure' test.xml
      xmlstarlet ed --inplace --rename '//testsuite/testcase/rerunFailure' -v 'failure' test.xml
      xmlstarlet ed --inplace --rename '//testsuite/testcase/flakyError' -v 'failure' test.xml</code></pre>
            </li>
        </ul>
    </li>
</ul>
<h2 id="h_01HSYTJTB65NXHQ187H4ER6SPF">Outcome:</h2>
<p>After adjusting the element names, your test results will be corrected parsed by CircleCI, and the invalid element error will no longer show.</p>
<h2 id="h_01HSYTJTB6TQFSYE0HJ35B28BR">Additional Notes:</h2>
<p>The above example shows how to rename specific elements, but there are cases when the nesting of elements is invalid as well. Please refer to the documentation below for more information:</p>
<p><a href="https://xmlstar.sourceforge.net/doc/UG/ch04s03.html" target="_blank" rel="noopener noreferrer">XmlStarlet Reference</a></p>
<h2 id="h_01HSYTJTB6HEXDDS7XZABCBF3Q">Additional Resources:Â </h2>
<ul>
    <li><a href="https://support.circleci.com/hc/en-us/articles/360021624194-Test-Summary-Troubleshooting" target="_blank" rel="noopener noreferrer">Test Summary Troubleshooting</a></li>
    <li><a href="https://circleci.com/docs/collect-test-data/" target="_blank" rel="noopener noreferrer">Collect Test Data</a></li>
    <li><a href="https://circleci.com/docs/use-the-circleci-cli-to-split-tests/#junit-xml-reports" target="_blank" rel="noopener noreferrer">Use the CircleCI CLI to split tests - JUnit XML reports</a></li>
    <li><a href="https://xmlstar.sourceforge.net/doc/UG/ch04s03.html" target="_blank" rel="noopener noreferrer">XmlStarlet Reference</a></li>
</ul>