<p><a href="https://discuss.circleci.com/t/advanced-logic-in-config/36011" target="_blank" rel="noopener">コンフィグファイルに高度なロジックが最近追加され</a>、ジョブでステップを条件付きでトリガーするオプションやワークフローを条件付きでトリガーするオプションを利用できるようになりました。</p>
<p><a href="https://circleci.com/docs/2.0/configuration-reference/#logic-statements" target="_blank" rel="noopener">特定のロジックステートメントを使用して</a>ネストされた複数の条件を作成できます。その条件の結果は常にトップレベルで<code> true </code>または<code> false </code>に評価され、ワークフローまたはステップをトリガーするかどうかが決定されます。</p>
<h3>ジョブステップの例</h3>
<pre>- when: <br>  condition: <br>    or: <br>      - and: <br>        - equal: [ main, &lt;&lt; pipeline.git.branch &gt;&gt; ] <br>        - or: [ &lt;&lt; pipeline.parameters.param1 &gt;&gt;, &lt;&lt; pipeline.parameters.param2 &gt;&gt; ]<br>      - or:<br>        - equal: [ false, &lt;&lt; pipeline.parameters.param1 &gt;&gt; ] <br>  steps:<br>    - run: echo "I am on main AND param1 is true OR param2 is true -- OR param1 is false"</pre>
<h3>ワークフローの例</h3>
<pre>workflows: <br>  conditional-workflow:<br>    when: <br>      and: # All must be true to trigger <br>        - equal: [ main, &lt;&lt; pipeline.git.branch &gt;&gt; ]<br>        - not: &lt;&lt; pipeline.parameters.param1 &gt;&gt; <br>        - or: [ &lt;&lt; pipeline.parameters.param1 &gt;&gt;, &lt;&lt; pipeline.parameters.param2 &gt;&gt; ]<br>  jobs: - job-on-condition</pre>
<p>最大 100 レベルの深さまで引数の仕様に応じて、条件を任意の方法でネストできます。 これにより、以下のようなネストされた複雑なロジックを作成できます。</p>
<pre>- when: <br>  condition: <br>    or: <br>      - and: <br>        - or: <br>          - and: <br>            - equal: [ main, &lt;&lt; pipeline.git.branch &gt;&gt; ]<br>            - equal: [ false, &lt;&lt; pipeline.parameters.param1 &gt;&gt; ] <br>          - or: <br>            - not: &lt;&lt; pipeline.parameters.param3 &gt;&gt; <br>        - or: <br>          - equal: [ false, &lt;&lt; pipeline.parameters.param3 &gt;&gt; ] <br>          - or: [ &lt;&lt; pipeline.parameters.param1 &gt;&gt;, &lt;&lt; pipeline.parameters.param2 &gt;&gt; ] <br>     - or: <br>       - equal: [ true, &lt;&lt; pipeline.parameters.param4 &gt;&gt; ] <br>  steps: - run: echo "param 4 is true OR the other nested conditions are true"</pre>
<p> </p>