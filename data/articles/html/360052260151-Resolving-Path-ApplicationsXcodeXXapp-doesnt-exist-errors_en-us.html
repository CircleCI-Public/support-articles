<h1>Deprecating Old Xcode Patch Versions</h1>
<p>A previously working Xcode build pipeline may start failing.</p>
<p>Our <a href="https://circleci.com/docs/2.0/xcode-policy/#xcode-patches">Xcode patch policy</a> states that we <span>retain the latest patch version of each Xcode </span><code class="highlighter-rouge">major.minor</code><span> version we support. Once a new patch version has been released, we will deprecate the previous patch version and redirect all requests to the new patch.</span></p>
<p>If your Fastlane configuration is relying on a hard-coded Xcode path, you may find that when a new patch version is realised that this will start to fail as the Xcode app path contains the version number of Xcode.</p>
<h2>Example</h2>
<p>You use the Xcode <code class="highlighter-rouge">12.1.0</code> image and specify <code class="highlighter-rouge">/Applications/Xcode-12.1.app</code> in one of your Fastlane actions.</p>
<p>We release Xcode <code class="highlighter-rouge">12.1.1</code> and redirect requests for <code class="highlighter-rouge">12.1.0</code> to this new image. Therefore the new Xcode app path is <code class="highlighter-rouge">/Applications/Xcode-12.1.1.app</code> and your job will fail on <code class="highlighter-rouge">Path '/Applications/Xcode-12.1.app' doesn't exist</code></p>
<h2>Best Practices for Avoiding Hard-coded Paths</h2>
<p>In each image, we always symlink Xcode to a generic path. For example:</p>
<p><code class="highlighter-rouge">/Applications/Xcode-12.1.app -&gt; /Applications/Xcode.app</code></p>
<p>The generic path remains consistent across all images, regardless of the Xcode version, and should be used for CircleCI jobs where possible.</p>
<p>We can also utilise a variable and CI environment test to avoid the use of a hard-coded path when running on CircleCI specifically. For example:</p>
<pre># fastlane/Fastfile<br><br>xcodePath = "/Applications/Xcode-12.1.app"<br><br>platform :iOS do<br>  before_all do<br>    setup_circle_ci<br>    <span class="hljs-keyword">if</span><span> is_ci</span><br>      xcodePath = "/Applications/Xcode.app"<br>    end<br>  end<br>  ...<br>end</pre>
<p>The above sets a variable, <code class="highlighter-rouge">xcodePath</code>, where we store the required path to Xcode. By using <code class="highlighter-rouge">if is_ci</code>we can check whether the job is running on CircleCI and set the generic Xcode path if this is true. This allows you to continue using a hardcoded path when dealing with a local environment, if required, whilst using the generic symlinked path on CircleCI which helps prevent breaking changes between Xcode version changes.</p>