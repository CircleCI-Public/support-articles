<p dir="auto"><span class="wysiwyg-font-size-large"><strong>Note: This article discusses caching in the Docker Executor relating to the "Spin Up Environment" step for the main container in the job. It <em>does not</em> apply to <a href="https://circleci.com/docs/2.0/docker-layer-caching/" target="_self">Docker Layer Caching</a> which is a feature of the <a href="https://circleci.com/docs/2.0/building-docker-images/" target="_self">Remote Docker environment</a>.</strong></span></p>
<p dir="auto">The time it takes to spin up a docker container to run a job can vary based on several different factors, such as the size of the image and if some, or all, of the layers, are already cached on the underlying Docker host machine.</p>
<p dir="auto">Generally, if you are using a popular image, such as <a href="https://circleci.com/docs/2.0/circleci-images/" target="_self">CircleCI Convenience Images</a>, then cache hits are more likely for a larger number of layers. Most of our popular CircleCI images use the same base image so the majority of the <em>base layers</em> will be the same between images and you, therefore, you have a greater chance of having a cache hit.</p>
<p dir="auto">The environment has to spin up for every new job, regardless of whether it is in the same workflow or if it is a re-run/subsequent run - for security reasons, we never reuse containers. Once the job is finished the container is destroyed. We cannot guarantee that jobs, even in the same workflow, will run on the same docker host machine and therefore the cache status may differ.</p>
<p dir="auto">Cache hits are not guaranteed, but are a bonus convenience when available. With this in mind, a worst-case scenario of a full image pull should be accounted for in all jobs.</p>
<p dir="auto">Docker Layer Caching is only beneficial when <em>building</em> an image <em>on CircleCI</em> by using the remote docker environment - it does not affect spin-up times for the actual docker containers used to <em>run</em> the job. More information about DLC can be found <a href="https://circleci.com/docs/2.0/docker-layer-caching/" rel="noreferrer">in our documentation</a>.</p>
<p dir="auto"> </p>
<h3 id="h_01HM789FTKJWF34P0XE0YE41E2" dir="auto">Extending Convenience Images</h3>
<p>If there aren't <a href="https://circleci.com/developer/images">Convenience Images</a> (<code>cimg/</code>) available that meet all of your build's needs, you can build custom images based on a Convenience Image and add necessary additions, such as dependencies. By doing this, you can increase the chances of hitting a cache and spinning up your jobs faster than if you were to build an entirely new image. To do this, you can add the following to the top of your Dockerfile:</p>
<pre>FROM cimg/&lt;image&gt;</pre>
<p dir="auto"> </p>
<p dir="auto">In summary, the availability of caching is not something that can be controlled via settings or configuration, but by choosing a popular image, such as <a href="https://circleci.com/docs/2.0/circleci-images/" target="_self">CircleCI Convenience Images</a>, you will have more cache of hitting cached layers in the "Spin Up Environment" Step.</p>