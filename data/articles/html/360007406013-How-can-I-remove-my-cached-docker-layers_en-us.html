<h2>Overview</h2>
<p><br>You may run into issues with cached docker layers when using them within your config.<br>If necessary, you can try removing (purging) the cached layers.</p>
<p>Â </p>
<h3>Remove the layers</h3>
<blockquote>
    <strong>Note:</strong> The underlying implementation of DLC is in the process of being updated. <br>All further content on this page refers to the implementation of DLC that is in the process of being phased out. <br>Once all jobs have been migrated to the new implementation, the content currently on this page will become outdated and will be replaced with information based on the new architecture.
</blockquote>
<p>Running <strong><span class="s1">docker images --no-trunc --format '{{.ID}}' | xargs docker rmi</span></strong><span class="s1"> or <strong>docker volume prune -f </strong>will delete all of the images and their layers from the volume connected to your job.</span></p>
<p><span class="s1">Because of <a href="https://circleci.com/docs/2.0/docker-layer-caching/#how-dlc-works" target="_blank" rel="noopener">how Docker Layer Caching (DLC) works</a> you might need to leave this command in your config and run several jobs to remove the Docker Layer Caching (DLC) layers from all volumes associated with your project.</span></p>
<p><span class="s1">You can use the config below to run a <strong>one-time</strong> job that consumes all 30 DLC volumes and purges docker caches. You can push it to a feature branch without disrupting your main branches:</span></p>
<pre style="background-color: #f3f3f3;"><span class="s1"><span class="na"><span class="hljs-attr">version</span></span><span class="pi"><span class="hljs-attr">:</span></span><span> </span><span class="m"><span class="hljs-number">2.1<br></span></span><span> </span><span class="na"><span class="hljs-attr">jobs</span></span><span class="pi"><span class="hljs-attr">:</span></span><span> </span><span class="hljs-attr"> <br></span><span class="na"><span class="hljs-attr">  docker-purge</span></span><span class="pi"><span class="hljs-attr">:</span></span><span class="na"><span class="hljs-attr"><br>    docker</span></span><span class="pi"><span class="hljs-attr">:</span></span><span> </span><span class="hljs-attr"> <br></span><span class="pi"><span class="hljs-attr">      -</span></span><span class="hljs-attr"> </span><span class="na"><span class="hljs-attr">image</span></span><span class="pi"><span class="hljs-attr">:</span></span><span> cimg/<span class="hljs-keyword">base</span>:<span class="hljs-number">2020.01</span></span><span class="hljs-string"> </span><span class="hljs-attr"> <br></span><span class="na"><span class="hljs-attr">    parallelism</span></span><span class="pi"><span class="hljs-attr">:</span></span><span> 30</span><span class="m"><span class="hljs-number"><br>    steps:<br>      - setup_remote_docker<br>      - run: docker volume prune -f</span></span></span></pre>
<h2><span class="s1">Stale volumes</span></h2>
<p><span class="s1">If you're running into issues of stale volumes somehow, consider using our new <a href="https://circleci.com/orbs/registry/orb/cci-x/docker-registry-image-cache" target="_blank" rel="noopener">docker registry image cache orb</a>. </span><span class="s1"><br><br></span></p>